<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Edit test message</title>
  </head>
  <body>
    <h1>Edit test message</h1>

    <p>Current: <span id="current">loading…</span></p>

    <p>
      New message:
      <input id="newmsg" />
      <button id="saveBtn">Save</button>
    </p>

    <p id="status"></p>

    <script>
      const SERVICE = "http://localhost:3010/testform.json";

      async function loadCurrent() {
        const res = await fetch(SERVICE, { cache: "no-store" });
        const data = await res.json();
        document.getElementById("current").textContent = data.message || "";
        document.getElementById("newmsg").value = data.message || "";
      }

      async function save() {
        const msg = document.getElementById("newmsg").value;
        const res = await fetch(SERVICE, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: msg })
        });
        const data = await res.json();
        if (data.ok) {
          document.getElementById("status").textContent = "saved ✔";
          // refresh current
          loadCurrent();
        } else {
          document.getElementById("status").textContent = "save failed";
        }
      }

      document.getElementById("saveBtn").addEventListener("click", save);
      loadCurrent();
    </script>
  </body>
</html>